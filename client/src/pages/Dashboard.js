import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useState, useEffect } from 'react';
import { apiClient } from '../lib/api';
import { DashboardIcon, RequestsIcon, InventoryIcon, SitesIcon, UsersIcon, ReportsIcon, SettingsIcon, MenuIcon, CloseIcon, SearchIcon, BellIcon, TrendingUpIcon, AlertTriangleIcon, CheckCircleIcon, ClockIcon } from '../components/icons';
export default function Dashboard({ onLogout }) {
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    const [activeTab, setActiveTab] = useState('overview');
    const [sidebarOpen, setSidebarOpen] = useState(false);
    // Mock data for now - will be replaced with real API calls
    const stats = {
        totalRequests: 45,
        pendingRequests: 12,
        approvedRequests: 28,
        lowStockItems: 8,
        totalUsers: 15,
        totalItems: 234
    };
    const recentActivity = [
        { id: 1, type: 'request', description: 'New request for office supplies', user: 'John Doe', time: '2 hours ago' },
        { id: 2, type: 'approval', description: 'Request #1234 approved', user: 'Jane Smith', time: '4 hours ago' },
        { id: 3, type: 'inventory', description: 'Low stock alert: Printer Paper', user: 'System', time: '6 hours ago' },
        { id: 4, type: 'user', description: 'New user added to organization', user: 'Admin', time: '1 day ago' },
    ];
    useEffect(() => {
        const fetchUser = async () => {
            try {
                const userData = await apiClient.getMe();
                setUser(userData.data?.user);
            }
            catch (err) {
                setError(err instanceof Error ? err.message : 'Failed to fetch user data');
            }
            finally {
                setLoading(false);
            }
        };
        fetchUser();
    }, []);
    const navigation = [
        { name: 'Overview', id: 'overview', icon: DashboardIcon, description: 'Dashboard overview' },
        { name: 'Requests', id: 'requests', icon: RequestsIcon, description: 'Manage supply requests' },
        { name: 'Inventory', id: 'inventory', icon: InventoryIcon, description: 'Catalogue & stock management' },
        { name: 'Sites & Areas', id: 'sites', icon: SitesIcon, description: 'Manage locations' },
        { name: 'Users', id: 'users', icon: UsersIcon, description: 'User management', adminOnly: true },
        { name: 'Reports', id: 'reports', icon: ReportsIcon, description: 'Analytics & reports' },
        { name: 'Settings', id: 'settings', icon: SettingsIcon, description: 'Organization settings', adminOnly: true },
    ];
    const isAdmin = user?.role === 'ADMIN';
    if (loading) {
        return (_jsx("div", { className: "min-h-screen flex items-center justify-center bg-neutral-50", children: _jsxs("div", { className: "text-center", children: [_jsx("div", { className: "spinner h-12 w-12 mx-auto" }), _jsx("p", { className: "mt-4 text-neutral-600", children: "Loading dashboard..." })] }) }));
    }
    if (error) {
        return (_jsx("div", { className: "min-h-screen flex items-center justify-center bg-neutral-50", children: _jsxs("div", { className: "text-center", children: [_jsx(AlertTriangleIcon, { className: "w-12 h-12 text-red-500 mx-auto mb-4" }), _jsx("p", { className: "text-neutral-600 mb-4", children: error }), _jsx("button", { onClick: () => window.location.reload(), className: "btn-primary", children: "Retry" })] }) }));
    }
    return (_jsxs("div", { className: "min-h-screen bg-neutral-50", children: [_jsx("header", { className: "bg-white border-b border-neutral-200 sticky top-0 z-40", children: _jsxs("div", { className: "flex items-center justify-between px-4 lg:px-6 h-16", children: [_jsxs("div", { className: "flex items-center space-x-8", children: [_jsxs("div", { className: "flex items-center space-x-3", children: [_jsx("div", { className: "w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center", children: _jsx("span", { className: "text-white font-bold text-sm", children: "OS" }) }), _jsx("h1", { className: "text-xl font-bold text-neutral-900 hidden sm:block", children: "OfficeStore" })] }), _jsx("nav", { className: "hidden lg:flex items-center space-x-1", children: navigation.map((item) => {
                                        if (item.adminOnly && !isAdmin)
                                            return null;
                                        const IconComponent = item.icon;
                                        return (_jsxs("button", { onClick: () => setActiveTab(item.id), className: `nav-item ${activeTab === item.id ? 'active' : ''}`, children: [_jsx(IconComponent, { className: "w-4 h-4 mr-2" }), item.name] }, item.id));
                                    }) })] }), _jsxs("div", { className: "flex items-center space-x-4", children: [_jsx("div", { className: "hidden md:flex items-center", children: _jsxs("div", { className: "relative", children: [_jsx(SearchIcon, { className: "absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutral-400" }), _jsx("input", { type: "text", placeholder: "Search...", className: "input pl-10 w-64" })] }) }), _jsxs("button", { className: "relative p-2 text-neutral-600 hover:text-neutral-900 hover:bg-neutral-100 rounded-lg", children: [_jsx(BellIcon, { className: "w-5 h-5" }), _jsx("span", { className: "absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full" })] }), _jsxs("div", { className: "flex items-center space-x-4", children: [_jsxs("div", { className: "hidden sm:flex items-center space-x-3 px-3 py-2 bg-neutral-100 rounded-lg", children: [_jsx("div", { className: "w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center", children: _jsxs("span", { className: "text-white text-sm font-semibold", children: [user?.first_name?.[0], user?.last_name?.[0]] }) }), _jsxs("div", { className: "text-right", children: [_jsxs("p", { className: "text-sm font-medium text-neutral-900", children: [user?.first_name, " ", user?.last_name] }), _jsx("p", { className: "text-xs text-neutral-500", children: user?.role })] })] }), _jsxs("button", { onClick: onLogout, className: "btn-secondary", children: [_jsx("span", { className: "hidden sm:inline", children: "Sign Out" }), _jsx("span", { className: "sm:hidden", children: "Exit" })] })] }), _jsx("button", { onClick: () => setSidebarOpen(true), className: "lg:hidden p-2 text-neutral-600 hover:text-neutral-900 hover:bg-neutral-100 rounded-lg", children: _jsx(MenuIcon, { className: "w-5 h-5" }) })] })] }) }), _jsxs("div", { className: `fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl transform ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'} transition-transform duration-300 ease-in-out lg:hidden`, children: [_jsxs("div", { className: "flex items-center justify-between h-16 px-6 border-b border-neutral-200", children: [_jsxs("div", { className: "flex items-center space-x-3", children: [_jsx("div", { className: "w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center", children: _jsx("span", { className: "text-white font-bold text-sm", children: "OS" }) }), _jsx("h1", { className: "text-xl font-bold text-neutral-900", children: "OfficeStore" })] }), _jsx("button", { onClick: () => setSidebarOpen(false), className: "p-2 rounded-lg text-neutral-400 hover:text-neutral-600 hover:bg-neutral-100", children: _jsx(CloseIcon, { className: "w-5 h-5" }) })] }), _jsx("nav", { className: "mt-6 px-3", children: _jsx("div", { className: "space-y-1", children: navigation.map((item) => {
                                if (item.adminOnly && !isAdmin)
                                    return null;
                                const IconComponent = item.icon;
                                return (_jsxs("button", { onClick: () => {
                                        setActiveTab(item.id);
                                        setSidebarOpen(false);
                                    }, className: `w-full nav-item ${activeTab === item.id ? 'active' : ''}`, children: [_jsx(IconComponent, { className: "w-4 h-4 mr-3" }), _jsxs("div", { className: "text-left", children: [_jsx("div", { children: item.name }), _jsx("div", { className: "text-xs text-neutral-500", children: item.description })] })] }, item.id));
                            }) }) })] }), _jsxs("main", { className: "flex-1 px-4 lg:px-6 py-6", children: [activeTab === 'overview' && (_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("h1", { className: "text-2xl font-bold text-neutral-900", children: "Dashboard Overview" }), _jsxs("p", { className: "text-neutral-600 mt-1", children: ["Welcome back, ", user?.first_name, "! Here's what's happening today."] })] }), _jsx("div", { className: "flex items-center space-x-3", children: _jsx("button", { className: "btn-secondary", children: _jsx("span", { className: "hidden sm:inline", children: "Export Report" }) }) })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6", children: [_jsx("div", { className: "card hover-lift", children: _jsx("div", { className: "card-body", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-neutral-600", children: "Total Requests" }), _jsx("p", { className: "text-3xl font-bold text-neutral-900 mt-2", children: stats.totalRequests }), _jsxs("div", { className: "flex items-center mt-2", children: [_jsx(TrendingUpIcon, { className: "w-4 h-4 text-green-500 mr-1" }), _jsx("span", { className: "text-sm text-green-600", children: "+12% from last week" })] })] }), _jsx("div", { className: "w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center", children: _jsx(RequestsIcon, { className: "w-6 h-6 text-blue-600" }) })] }) }) }), _jsx("div", { className: "card hover-lift", children: _jsx("div", { className: "card-body", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-neutral-600", children: "Pending Requests" }), _jsx("p", { className: "text-3xl font-bold text-neutral-900 mt-2", children: stats.pendingRequests }), _jsxs("div", { className: "flex items-center mt-2", children: [_jsx(ClockIcon, { className: "w-4 h-4 text-yellow-500 mr-1" }), _jsx("span", { className: "text-sm text-yellow-600", children: "Needs attention" })] })] }), _jsx("div", { className: "w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center", children: _jsx(ClockIcon, { className: "w-6 h-6 text-yellow-600" }) })] }) }) }), _jsx("div", { className: "card hover-lift", children: _jsx("div", { className: "card-body", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-neutral-600", children: "Low Stock Items" }), _jsx("p", { className: "text-3xl font-bold text-neutral-900 mt-2", children: stats.lowStockItems }), _jsxs("div", { className: "flex items-center mt-2", children: [_jsx(AlertTriangleIcon, { className: "w-4 h-4 text-red-500 mr-1" }), _jsx("span", { className: "text-sm text-red-600", children: "Requires restocking" })] })] }), _jsx("div", { className: "w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center", children: _jsx(AlertTriangleIcon, { className: "w-6 h-6 text-red-600" }) })] }) }) }), _jsx("div", { className: "card hover-lift", children: _jsx("div", { className: "card-body", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-neutral-600", children: "Total Items" }), _jsx("p", { className: "text-3xl font-bold text-neutral-900 mt-2", children: stats.totalItems }), _jsxs("div", { className: "flex items-center mt-2", children: [_jsx(CheckCircleIcon, { className: "w-4 h-4 text-green-500 mr-1" }), _jsx("span", { className: "text-sm text-green-600", children: "In inventory" })] })] }), _jsx("div", { className: "w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center", children: _jsx(InventoryIcon, { className: "w-6 h-6 text-green-600" }) })] }) }) })] }), _jsxs("div", { className: "grid grid-cols-1 xl:grid-cols-3 gap-6", children: [_jsx("div", { className: "xl:col-span-2", children: _jsxs("div", { className: "card", children: [_jsx("div", { className: "card-header", children: _jsxs("div", { className: "flex items-center justify-between", children: [_jsx("h3", { className: "text-lg font-semibold text-neutral-900", children: "Recent Activity" }), _jsx("button", { className: "btn-ghost text-sm", children: "View All" })] }) }), _jsx("div", { className: "divide-y divide-neutral-100", children: recentActivity.map((activity) => (_jsxs("div", { className: "px-6 py-4 flex items-center justify-between hover:bg-neutral-50 transition-colors", children: [_jsxs("div", { className: "flex items-center space-x-3", children: [_jsx("div", { className: `w-3 h-3 rounded-full ${activity.type === 'request' ? 'bg-blue-500' :
                                                                            activity.type === 'approval' ? 'bg-green-500' :
                                                                                activity.type === 'inventory' ? 'bg-red-500' : 'bg-neutral-500'}` }), _jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-neutral-900", children: activity.description }), _jsxs("p", { className: "text-xs text-neutral-500", children: ["by ", activity.user] })] })] }), _jsx("div", { className: "text-right", children: _jsx("span", { className: "text-xs text-neutral-400", children: activity.time }) })] }, activity.id))) })] }) }), _jsx("div", { children: _jsxs("div", { className: "card", children: [_jsx("div", { className: "card-header", children: _jsx("h3", { className: "text-lg font-semibold text-neutral-900", children: "Quick Actions" }) }), _jsxs("div", { className: "card-body space-y-3", children: [_jsxs("button", { className: "w-full flex items-center p-3 border border-neutral-200 rounded-lg hover:bg-neutral-50 hover:border-blue-300 transition-all group", children: [_jsx("div", { className: "w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-blue-200 transition-colors", children: _jsx(RequestsIcon, { className: "w-5 h-5 text-blue-600" }) }), _jsxs("div", { className: "text-left", children: [_jsx("div", { className: "font-medium text-neutral-900", children: "New Request" }), _jsx("div", { className: "text-sm text-neutral-500", children: "Submit supply request" })] })] }), _jsxs("button", { className: "w-full flex items-center p-3 border border-neutral-200 rounded-lg hover:bg-neutral-50 hover:border-green-300 transition-all group", children: [_jsx("div", { className: "w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-green-200 transition-colors", children: _jsx(InventoryIcon, { className: "w-5 h-5 text-green-600" }) }), _jsxs("div", { className: "text-left", children: [_jsx("div", { className: "font-medium text-neutral-900", children: "Add Item" }), _jsx("div", { className: "text-sm text-neutral-500", children: "Add to catalogue" })] })] }), isAdmin && (_jsxs(_Fragment, { children: [_jsxs("button", { className: "w-full flex items-center p-3 border border-neutral-200 rounded-lg hover:bg-neutral-50 hover:border-purple-300 transition-all group", children: [_jsx("div", { className: "w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-purple-200 transition-colors", children: _jsx(UsersIcon, { className: "w-5 h-5 text-purple-600" }) }), _jsxs("div", { className: "text-left", children: [_jsx("div", { className: "font-medium text-neutral-900", children: "Invite User" }), _jsx("div", { className: "text-sm text-neutral-500", children: "Add team member" })] })] }), _jsxs("button", { className: "w-full flex items-center p-3 border border-neutral-200 rounded-lg hover:bg-neutral-50 hover:border-orange-300 transition-all group", children: [_jsx("div", { className: "w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-orange-200 transition-colors", children: _jsx(SitesIcon, { className: "w-5 h-5 text-orange-600" }) }), _jsxs("div", { className: "text-left", children: [_jsx("div", { className: "font-medium text-neutral-900", children: "Add Site" }), _jsx("div", { className: "text-sm text-neutral-500", children: "Create new location" })] })] })] }))] })] }) })] })] })), activeTab !== 'overview' && (_jsx("div", { className: "flex items-center justify-center min-h-[60vh]", children: _jsx("div", { className: "card max-w-md w-full", children: _jsxs("div", { className: "card-body text-center", children: [_jsx("div", { className: "w-16 h-16 bg-neutral-100 rounded-full flex items-center justify-center mx-auto mb-4", children: (() => {
                                            const currentNav = navigation.find(nav => nav.id === activeTab);
                                            if (currentNav) {
                                                const IconComponent = currentNav.icon;
                                                return _jsx(IconComponent, { className: "w-8 h-8 text-neutral-500" });
                                            }
                                            return null;
                                        })() }), _jsx("h3", { className: "text-xl font-semibold text-neutral-900 mb-2", children: navigation.find(nav => nav.id === activeTab)?.name }), _jsx("p", { className: "text-neutral-600 mb-4", children: "This section is under development. Full functionality will be available soon." }), _jsx("button", { className: "btn-primary", children: "Get Notified When Ready" })] }) }) }))] }), sidebarOpen && (_jsx("div", { className: "fixed inset-0 bg-black/50 z-40 lg:hidden", onClick: () => setSidebarOpen(false) }))] }));
}
